var watermarkObj=function(e){"use strict";function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var r=function(e){for(var t=e.str,n=e.ctx,r=e.initX,i=e.initY,o=e.lineHeight,a=(e.canvasWidth,0),c=0;c<t.length;c++)n.measureText(t[c]).width,c==t.length-1&&n.fillText(t.substring(a,c+1),r,i),"-"==t[c]&&(0,n.fillText(t.slice(a,c),r,i),i+=o,a=c+1)},i=function(e,t){var n=null;n=e?document.querySelector(e):document.body;var r=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;return!!r&&(new r(t).observe(n,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0}),!0)},o={id:"wm_div_id",text:"测试水印",transparency:.15,fontSize:16,parentLeft:0,parentTop:0,parentRight:0,parentBottom:0,singleWidth:200,singleHeight:200,slope:-15,zIndex:9999,parentSelector:null};function a(e){var i=function(e){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?n(i,!0).forEach((function(n){t(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(i).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},o,{},e);c.set(i.id,i);var a=null;if(i.parentSelector?(a=document.querySelector(i.parentSelector)).style.position="relative":a=document.body,!document.getElementById(i.id)){var l=document.createElement("canvas"),s=document.createElement("div"),d=l.getContext("2d"),u=i.slope*Math.PI/180;l.id="watermarkCanvasId",l.width=i.singleWidth,l.height=i.singleHeight,d.font="normal ".concat(i.fontSize,"px 'Microsoft Yahei','serif','sans-serif'"),d.fillStyle="rgba(112, 113, 114, ".concat(i.transparency,")"),d.translate(l.width/2,l.height/2),d.rotate(u),d.translate(-l.width/2,-l.height/2),d.textAlign="center";var p=i.fontSize+i.fontSize/3,f=Math.ceil(Math.abs(Math.sin(u)*i.singleHeight))+i.fontSize/3,g={str:i.text,ctx:d,initX:i.singleWidth/2,initY:f,lineHeight:p,canvasWidth:i.singleWidth};r(g);var h=l.toDataURL("image/png");s.id=i.id,s.style.position="absolute",s.style.zIndex=i.zIndex,s.style.top="".concat(i.parentTop,"px"),s.style.right="".concat(i.parentRight,"px"),s.style.bottom="".concat(i.parentBottom,"px"),s.style.left="".concat(i.parentLeft,"px"),s.style.pointerEvents="none",s.style.backgroundImage="URL("+h+")",a.appendChild(s)}}var c=new Map;return e.customSettingMap=c,e.getWatermarkConfig=function(e){return c.get(e)},e.removeWatermark=function(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)},e.watermark=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(e),window.addEventListener("resize",(function(){a(e)}));var t=e.id||o.id,n=e.parentSelector||o.parentSelector;i(n,(function(n,r){n[0].removedNodes[0]&&n[0].removedNodes[0].id===t&&a(e)}))||observeNode.addEventListener("DOMNodeRemoved",(function(){a(e)}),!1)},e}({});
