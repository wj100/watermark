function t(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function n(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var r=function(t){for(var e=t.str,n=t.ctx,r=t.initX,i=t.initY,o=t.lineHeight,a=(t.canvasWidth,0),l=0;l<e.length;l++)n.measureText(e[l]).width,l==e.length-1&&n.fillText(e.substring(a,l+1),r,i),"\n"==e[l]&&(0,n.fillText(e.slice(a,l),r,i),i+=o,a=l+1)},i=function(t,e){var n=null;n=t?document.querySelector(t):document.body;var r=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;return!!r&&(new r(e).observe(n,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0}),!0)},o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=function(t){return document.createElement("canvas").getContext("2d").measureText(t).width},o=t.split("\n"),a=o.map((function(t){return i(t)})),l=Math.max.apply(Math,n(a)),c=1.5*l,d=1.2*l,s={width:c*(1+(100-e)/100*r),height:d*(1+(100-e)/100*r)};return function(t){return s[t]}},a={id:"wm_div_id",text:"测试水印",color:"rgba(112, 113, 114, .1)",fontSize:14,parentLeft:0,parentTop:0,parentRight:0,parentBottom:0,slope:-30,zIndex:9999,parentSelector:null};function l(n){var i=function(n){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?e(i,!0).forEach((function(e){t(n,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):e(i).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(i,t))}))}return n}({},a,{},n);d.set(i.id,i);var o=null;if(i.parentSelector?(o=document.querySelector(i.parentSelector)).style.position="relative":o=document.body,!document.getElementById(i.id)){var l=document.createElement("canvas"),c=document.createElement("div"),s=l.getContext("2d"),u=i.slope*Math.PI/180;l.id="watermarkCanvasId",l.width=i.singleWidth,l.height=i.singleHeight,s.font="normal ".concat(i.fontSize,"px 'Microsoft Yahei','serif','sans-serif'"),s.fillStyle=i.color,s.translate(l.width/2,l.height/2),s.rotate(u),s.translate(-l.width/2,-l.height/2),s.textAlign="center";var p=i.fontSize+i.fontSize/3,h=Math.ceil(Math.abs(Math.sin(u)*i.singleHeight))+i.fontSize/3,g={str:i.text,ctx:s,initX:i.singleWidth/2,initY:h,lineHeight:p,canvasWidth:i.singleWidth};r(g);var f=l.toDataURL("image/png");c.id=i.id,c.style.position="absolute",c.style.zIndex=i.zIndex,c.style.top="".concat(i.parentTop,"px"),c.style.right="".concat(i.parentRight,"px"),c.style.bottom="".concat(i.parentBottom,"px"),c.style.left="".concat(i.parentLeft,"px"),c.style.pointerEvents="none",c.style.backgroundImage="URL("+f+")",o.appendChild(c)}}var c=new Map,d=new Map;function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.singleHeight=t.singleHeight||o(t.text,t.density,t.densityBase)("height"),t.singleWidth=t.singleWidth||o(t.text,t.density,t.densityBase)("width"),l(t),window.addEventListener("resize",(function(){!c.get(Symbol(t.id))&&l(t)}));var e=t.id||a.id,n=t.parentSelector||a.parentSelector;i(n,(function(n,r){n[0].removedNodes[0]&&n[0].removedNodes[0].id===e&&!c.get(Symbol(t.id))&&l(t)}))||observeNode.addEventListener("DOMNodeRemoved",(function(){!c.get(Symbol(t.id))&&l(t)}),!1)}function u(t){var e=document.getElementById(t);e&&e.parentNode.removeChild(e),c.set(Symbol(t),!0)}function p(t){return d.get(t)||{}}var h=o;export{d as customSettingMap,h as getSingleWH,p as getWatermarkConfig,u as removeWatermark,s as watermark};
